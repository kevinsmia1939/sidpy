

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>GPU Computing Using CuPy &mdash; sidpy 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery-dataframe.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> sidpy
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="about.html">sidpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="external_guides.html">Tutorials on Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="auto_examples/index.html">Examples &amp; Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="contribution_guidelines.html">Guidelines for Contribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact us</a></li>
<li class="toctree-l1"><a class="reference internal" href="credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="matlab_to_python.html">Upgrading from Matlab</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">sidpy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>GPU Computing Using CuPy</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/cpu_to_gpu.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="gpu-computing-using-cupy">
<h1>GPU Computing Using CuPy<a class="headerlink" href="#gpu-computing-using-cupy" title="Permalink to this headline">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Authors</dt>
<dd class="field-odd"><p>Emily Costa</p>
</dd>
<dt class="field-even">Created on</dt>
<dd class="field-even"><p>08/07/2019</p>
</dd>
</dl>
<p>Enabling GPU computing, by implementing CuPy in the Bayesian Inference package of pycroscopy, was completed.
The following are lessons learned during the exploration of implementing CuPy for GPU computing in pyUSID functions:</p>
<div class="section" id="expanding-dimensions">
<h2>Expanding Dimensions<a class="headerlink" href="#expanding-dimensions" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">CuPy</span></code> does not have a <code class="docutils literal notranslate"><span class="pre">newaxis</span></code> function, like <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> does.
Instead of using new axis to add an additional dimension, you need to use <code class="docutils literal notranslate"><span class="pre">cupy.expand_dims()</span></code>.
Also, note that cupy does not lose a dimension during operations with vectors, like <code class="docutils literal notranslate"><span class="pre">numpy</span></code>,
so adding another dimension is often unnecessary as there are no singular dimensions in <code class="docutils literal notranslate"><span class="pre">cupy</span></code>.
All vectors are converted into row vectors in <code class="docutils literal notranslate"><span class="pre">numpy</span></code> after being operated on,
which can be dealt with by adding a new axis and converting back into a column vector for further matrix operations.</p>
<p>The following is an example of how <code class="docutils literal notranslate"><span class="pre">numpy</span></code>’s <code class="docutils literal notranslate"><span class="pre">newawaxis</span></code> function and how to use <code class="docutils literal notranslate"><span class="pre">cupy</span></code>’s <code class="docutils literal notranslate"><span class="pre">expand_dims</span></code> in its place:</p>
<div class="section" id="numpy-newaxis">
<h3><code class="docutils literal notranslate"><span class="pre">numpy.newaxis</span></code><a class="headerlink" href="#numpy-newaxis" title="Permalink to this headline">¶</a></h3>
<p>Import all necessary modules</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<p>1D array</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">arr</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">(5,)</span></code></p>
<p>Make the 1D array becomes a row vector when an axis is inserted along 1st dimension</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">row_vec</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">row_vec</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">5)</span></code></p>
<p>Make the 1D array becomes a column vector when an axis is inserted along 1st dimension</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">col_vec</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
<span class="n">col_vec</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">(5,</span> <span class="pre">1)</span></code></p>
</div>
<div class="section" id="cupy-expand-dims">
<h3><code class="docutils literal notranslate"><span class="pre">cupy.expand_dims</span></code><a class="headerlink" href="#cupy-expand-dims" title="Permalink to this headline">¶</a></h3>
<p>Import all necessary modules</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cupy</span> <span class="k">as</span> <span class="nn">cp</span>
</pre></div>
</div>
<p>1D array</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cp_arr</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">cp_arr</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">(5,)</span></code></p>
<p>Make the 1D array becomes a row vector when an axis is inserted along 1st dimension</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cp_row_vec</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">cp_arr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">cp_row_vec</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">5)</span></code></p>
<p>Make the 1D array becomes a column vector when an axis is inserted along 1st dimension</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cp_col_vec</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">cp_arr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cp_col_vec</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">(5,</span> <span class="pre">1)</span></code></p>
</div>
</div>
<div class="section" id="append">
<h2>Append<a class="headerlink" href="#append" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">CuPy</span></code> does not have an <code class="docutils literal notranslate"><span class="pre">append</span></code> function like <code class="docutils literal notranslate"><span class="pre">numpy</span></code> does. The <code class="docutils literal notranslate"><span class="pre">append</span></code> function in <code class="docutils literal notranslate"><span class="pre">numpy</span></code> appends values to the end of an array.</p>
<p>The following is an example of <code class="docutils literal notranslate"><span class="pre">numpy</span></code>’s <code class="docutils literal notranslate"><span class="pre">append</span></code> function and how to use <code class="docutils literal notranslate"><span class="pre">cupy</span></code>’s <code class="docutils literal notranslate"><span class="pre">concatonate</span></code> instead:</p>
<div class="section" id="numpy-append">
<h3><code class="docutils literal notranslate"><span class="pre">numpy.append</span></code><a class="headerlink" href="#numpy-append" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
<span class="n">xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">xy</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">array([1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">5,</span> <span class="pre">6])</span></code></p>
</div>
<div class="section" id="cupy-concatenate">
<h3><code class="docutils literal notranslate"><span class="pre">cupy.concatenate</span></code><a class="headerlink" href="#cupy-concatenate" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cp_x</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">cp_y</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">cp_xy</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">cp_x</span><span class="p">,</span><span class="n">cp_y</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">cp_xy</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">array([1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">5,</span> <span class="pre">6])</span></code></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Suhas Somnath, Cris R. Smith, and contributors

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>